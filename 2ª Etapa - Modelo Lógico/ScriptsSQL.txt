CREATE TABLE ALUNO(
	Codigo INT,
	Nome VARCHAR(100) NOT NULL,
	Sexo CHAR NOT NULL,
	Idade INT NOT NULL,
	Peso REAL NOT NULL,
	Altura REAL NOT NULL,
	BF VARCHAR(4) NOT NULL,
	IMC REAL NOT NULL,
	Telefone VARCHAR(20),
	EstadoSaude VARCHAR(50) NOT NULL,
	Objetivo VARCHAR(100) NOT NULL,
	CONSTRAINT  AlunoPK PRIMARY KEY (Codigo),
        CHECK(Peso>0),
        CHECK(Altura>0)
);

CREATE TABLE MATRICULA(
	Codigo INT,
	DataAbertura DATE NOT NULL,
	DataTrancamento DATE,
	CodigoAluno INT NOT NULL UNIQUE,
	CONSTRAINT  MatriculaPK PRIMARY KEY (Codigo),
	CONSTRAINT MatriculaFK FOREIGN KEY (CodigoAluno) 
		REFERENCES ALUNO(Codigo)
);

CREATE TABLE MENSALIDADE(
	Codigo INT,
	CodigoAluno INT NOT NULL UNIQUE,
	Valor REAL NOT NULL,
	DataRecibo DATE,
	DataPagamento DATE,
	CONSTRAINT MensalidadePK PRIMARY KEY (Codigo),
	CONSTRAINT MensalidadeFK FOREIGN KEY (CodigoAluno)
		REFERENCES ALUNO(Codigo),
        CHECK(Valor>0)	

);

CREATE TABLE TREINO(
	Codigo INT,
	Tipo VARCHAR(10) NOT NULL,
	DescansoEntreSeries VARCHAR(5) NOT NULL,
	UsoDeCarga VARCHAR(10) NOT NULL,
	DescansoEntreRepetiçoes VARCHAR(5) NOT NULL,
	DescansoEntreCiclo INT NOT NULL,
	Descriçao VARCHAR(200),
	CONSTRAINT TreinoPK PRIMARY KEY (Codigo)
);

CREATE TABLE ALUNO_Tem_TREINO(
	CodigoAluno INT,
	CodigoTreino INT,
	Duraçao TIME NOT NULL,
	DataInicio DATE NOT NULL,
	CONSTRAINT Aluno_Tem_TreinoPK PRIMARY KEY (CodigoAluno, CodigoTreino),
        CONSTRAINT Aluno_Tem_TreinoFK FOREIGN KEY (CodigoAluno) 
        	REFERENCES ALUNO(Codigo),
        CONSTRAINT Aluno_Tem_TreinoFK2 FOREIGN KEY (Codigotreino) 
        	REFERENCES TREINO(Codigo)
);

CREATE TABLE EXERCICIO(
	Codigo INT,
	Tipo VARCHAR(5) NOT NULL,
	Series INT NOT NULL,
	Repetiçoes INT NOT NULL,
	Nome VARCHAR(100) NOT NULL,
	Musculo VARCHAR(20) NOT NULL,
	DropSet BOOLEAN NOT NULL,
	CONSTRAINT ExercicioPK PRIMARY KEY (Codigo),
        CHECK(Series>0),
        CHECK(Repetiçoes>6)
);

CREATE TABLE TREINO_Tem_EXERCICIO(
	CodigoTreino INT,
	CodigoExercicio INT,
	CONSTRAINT Treino_Tem_ExercicioPK PRIMARY KEY (CodigoTreino, CodigoExercicio),
        CONSTRAINT Treino_Tem_ExercicioFK FOREIGN KEY (CodigoTreino) 
        	REFERENCES TREINO(Codigo),
        CONSTRAINT Treino_Tem_ExercicioFK2 FOREIGN KEY (CodigoExercicio) 
        	REFERENCES EXERCICIO(Codigo)
);

CREATE TABLE PROFESSOR(
	Codigo INT,
	Nome VARCHAR(100) NOT NULL,
	CPF VARCHAR(14) NOT NULL UNIQUE,
	Sexo CHAR NOT NULL,
        DataPagamento DATE NOT NULL,
	Salario REAL NOT NULL,
	CONSTRAINT ProfessorPK PRIMARY KEY (Codigo),
        CHECK(Salario>0)
);

CREATE TABLE EspecialidadePROFESSOR(
	CodigoProfessor INT,
	Especialidade VARCHAR(100),
	CONSTRAINT EspecialidadeProfessorPK PRIMARY KEY (CodigoProfessor, Especialidade),
        CONSTRAINT EspecialidadeProfessorFK FOREIGN KEY (CodigoProfessor) 
        	REFERENCES PROFESSOR(Codigo)
); 

CREATE TABLE PROFESSOR_EXERCICIO(
	CodigoProfessor INT,
	CodigoTreino INT,
	CodigoExercicio INT,
	CONSTRAINT Professor_ExercicioPK PRIMARY KEY (CodigoProfessor, 
		CodigoTreino, CodigoExercicio),
        CONSTRAINT Professor_ExercicioFK FOREIGN KEY (CodigoProfessor) 
        	REFERENCES PROFESSOR(Codigo),
        CONSTRAINT Professor_ExercicioFK2 FOREIGN KEY (CodigoTreino) 
        	REFERENCES TREINO(Codigo),
        CONSTRAINT Professor_ExercicioFK3 FOREIGN KEY (CodigoExercicio) 
        	REFERENCES EXERCICIO(Codigo)
); 

CREATE TABLE GERENTE(
	Codigo INT,
	Nome VARCHAR(100) NOT NULL,
	CPF VARCHAR(14) NOT NULL UNIQUE,
	Sexo CHAR NOT NULL,
	DataPagamento DATE NOT NULL,
	LucroMensal REAL NOT NULL,
	CONSTRAINT GerentePK PRIMARY KEY (Codigo)
);

CREATE TABLE DESPESA(
	Codigo INT,
	Valor REAL NOT NULL,
	Descriçao VARCHAR(100) NOT NULL,
        Data DATE NOT NULL,
	CONSTRAINT DespesaPK PRIMARY KEY (Codigo)
);

CREATE TABLE GERENTE_Gerencia_DESPESA(
	CodigoGerente INT,
	CodigoDespesa INT,
	CONSTRAINT GERENTE_Gerencia_DESPESAPK PRIMARY KEY (CodigoGerente, CodigoDespesa),
        CONSTRAINT Gerente_Gerencia_DespesaFK FOREIGN KEY (CodigoGerente) 
        	REFERENCES GERENTE(Codigo),
        CONSTRAINT Gerente_Gerencia_DespesaFK2 FOREIGN KEY (CodigoDespesa) 
        	REFERENCES DESPESA(Codigo)
);

CREATE TABLE COMPRA(
	Codigo INT,
	CodigoAluno INT,
	CNPJouCPF VARCHAR(20) NOT NULL UNIQUE,
	Descriçao VARCHAR(100) NOT NULL,
	Valor REAL NOT NULL,
	Data DATE NOT NULL,
	CONSTRAINT CompraPK PRIMARY KEY (Codigo),
	CONSTRAINT CompraFK FOREIGN KEY (CodigoAluno)
		REFERENCES ALUNO(Codigo),
        CHECK(Valor>0)
);

CREATE TABLE COMPRAaPRAZO(
	Codigo INT,
	ValorParcela REAL NOT NULL,
	Quitada BOOLEAN NOT NULL,
	Parcelas INT NOT NULL,
	CONSTRAINT CompraAprazoPK PRIMARY KEY (Codigo),
        CHECK(ValorParcela>0),
        CHECK(Parcelas>0 AND Parcelas<=5)
        
);

CREATE TABLE COMPRAaVISTA(
	Codigo INT,
	Desconto REAL NOT NULL,
	CONSTRAINT CompraAvistaPK PRIMARY KEY (Codigo),
        CHECK(Desconto>0)
);

CREATE TABLE GERENTE_Realiza_COMPRA(
	CodigoGerente INT,
	CodigoCompra INT,
	Data DATE NOT NULL,
	CONSTRAINT Gerente_Realiza_CompraPK PRIMARY KEY (CodigoGerente, CodigoCompra),
        CONSTRAINT Gerente_Realiza_CompraFK FOREIGN KEY (CodigoGerente)
		REFERENCES GERENTE(Codigo),
        CONSTRAINT Gerente_Realiza_CompraFK2 FOREIGN KEY (CodigoCompra)
		REFERENCES COMPRA(Codigo)
);

CREATE TABLE PRODUTO(
	Codigo INT,
	Preço REAL NOT NULL,
	Nome VARCHAR(100) NOT NULL,
	Marca VARCHAR(50) NOT NULL,
	Quantidade INT NOT NULL,
	CONSTRAINT PRODUTOPK PRIMARY KEY (Codigo),
        CHECK(Preço>0),
        CHECK(Quantidade>0)
);

CREATE TABLE COMPRA_Contem_PRODUTO(
	CodigoCompra INT,
	CodigoProduto INT,
	CONSTRAINT Compra_Contem_ProdutoPK PRIMARY KEY (CodigoCompra, CodigoProduto),
        CONSTRAINT Compra_Contem_ProdutoFK FOREIGN KEY (CodigoCompra)
		REFERENCES COMPRA(Codigo),
        CONSTRAINT Compra_Contem_ProdutoFK2 FOREIGN KEY (CodigoProduto)
		REFERENCES Produto(Codigo)
);

CREATE TABLE MEDIDAS(
	Codigo INT,
	Abdome REAL NOT NULL,
	CoxaDireita REAL NOT NULL,
	CoxaEsquerda REAL NOT NULL,
	BraçoDireito REAL NOT NULL,
	BraçoEsquerdo REAL NOT NULL,
	Peitoral REAL NOT NULL,
	AntebraçoDireito REAL NOT NULL,
	AntebraçoEsquerdo REAL NOT NULL,
	Deltoides REAL NOT NULL,
	PanturrilhaDireita REAL NOT NULL,
	PanturrilhaEsquerda REAL NOT NULL,
	CONSTRAINT MEDIDASPK PRIMARY KEY (Codigo)
);

CREATE TABLE PROFESSOR_ALUNO(
	CodigoProfessor INT,
	CodigoAluno INT,
	CodigoMedidas INT,
	Data DATE NOT NULL,
	CONSTRAINT Professor_AlunoPK PRIMARY KEY (CodigoProfessor, CodigoAluno, CodigoMedidas),
        CONSTRAINT Professor_AlunoFK FOREIGN KEY (CodigoProfessor)
		REFERENCES PROFESSOR(Codigo),
        CONSTRAINT Professor_AlunoFK2 FOREIGN KEY (CodigoAluno)
		REFERENCES ALUNO(Codigo),
        CONSTRAINT Professor_AlunoFK3 FOREIGN KEY (CodigoMedidas)
		REFERENCES MEDIDAS(Codigo)
);



